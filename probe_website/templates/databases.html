{% extends "master.html" %}

{% block title %}Databases{% endblock %}

{% block body %}

<h1>Database setup</h1>
<br/>
<p class="lead">Here you add information about the database(s) the probes should send measurement data to.</p>
<br/>

{% if message is string and message != '' %}
<p style="color:red;">{{ message }}</p>
<br/>
{% endif %}

<form class="form-horizontal" method="POST">

  {% for db_type, db in dbs.items() %}
    {% if db_type == 'influxdb' %}
    <h2>InfluxDB</h2>
    <div class="form-group">
      <label class="col-sm-2 control-label">Server address (IP / DNS record)</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" name="database.{{ db.id }}.address" value="{{ db.address }}" required/>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">Server port</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" name="database.{{ db.id }}.port" value="{{ db.port }}" required/>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">Database name</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" name="database.{{ db.id }}.db_name" value="{{ db.db_name }}" required/>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">Username</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" name="database.{{ db.id }}.username" value="{{ db.username }}" required/>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">Password</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" name="database.{{ db.id }}.password" value="{{ db.password }}" required/>
      </div>
    </div>
    {% endif %}
  {% endfor %}

  <button type="submit" class="btn btn-lg btn-default" name="save">Save configuration</button>
</form>

{% endblock %}
